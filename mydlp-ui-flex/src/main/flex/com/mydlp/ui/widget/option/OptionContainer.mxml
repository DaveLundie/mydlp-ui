<?xml version="1.0" encoding="utf-8"?>
<s:SkinnableContainer xmlns:fx="http://ns.adobe.com/mxml/2009"
					  xmlns:s="library://ns.adobe.com/flex/spark"
					  xmlns:mx="library://ns.adobe.com/flex/mx"
					  xmlns:option="com.mydlp.ui.widget.option.*"
					  xmlns:my="http://www.mydlp.com/flex/my"
					  width="100%" height="100%" 
					  creationComplete="{re.getConfigs()}">
	<fx:Script>
		<![CDATA[
			import com.mydlp.ui.domain.Config;
			
			import mx.collections.ListCollectionView;
			import mx.rpc.events.ResultEvent;
			
			[Bindable]
			protected var configs:ListCollectionView = null;
			
			protected function getConfigsHandler(event:ResultEvent):void
			{
				configs = event.result as ListCollectionView;
				populate();
			}
			
			protected function populate():void
			{
				if (configs == null) return;
				for each (var c:* in configs)
				{
					var config:Config = c as Config;
					if (config.key == "error_action") advancedTab.errorAction = config;
				}
			}
			
			protected function saveButtonHandler(event:MouseEvent):void
			{
				re.saveAll(configs);
				saveButton.enabled = false;
			}
			
			protected function saveAllHandler(event:ResultEvent):void
			{
				saveButton.enabled = true;
			}
			
		]]>
	</fx:Script>
	
	<fx:Declarations>
		<my:remote id="re" destination="configBRS">
			<my:method name="getConfigs" result="getConfigsHandler(event)"/>
			<my:method name="saveAll" result="saveAllHandler(event)"/>
		</my:remote>
	</fx:Declarations>
	
	<s:layout>
		<s:VerticalLayout gap="0" paddingTop="4" />
	</s:layout>
	
	<s:TabBar dataProvider="{vs}" fontWeight="bold" fontSize="14"/>
	
	<s:Group width="100%" height="100%">
		<s:Rect left="0" right="0" top="0" bottom="0" >
			<s:stroke>
				<s:SolidColorStroke color="0xACADAF" weight="3"/>
			</s:stroke>
		</s:Rect>
		<s:VGroup paddingTop="6" paddingBottom="6" paddingLeft="6" paddingRight="6" width="100%" height="100%">
			<mx:ViewStack id="vs" width="100%" height="100%" creationPolicy="all">
				<s:NavigatorContent label="@Resource(bundle = 'messages', key = 'options.tab.advanced')" width="100%" height="100%">
					<option:AdvancedTab id="advancedTab" />
				</s:NavigatorContent>
				<s:NavigatorContent label="@Resource(bundle = 'messages', key = 'options.tab.user')" width="100%" height="100%">
					<option:UserManagerBox id="userManagerBox" />
				</s:NavigatorContent>
			</mx:ViewStack>
		</s:VGroup>
	</s:Group>
	
	<s:Spacer height="10" />
	
	<s:HGroup paddingLeft="20">
		<s:Button id="saveButton" label="@Resource(bundle = 'messages', key = 'options.button.save.label')" 
				  click="saveButtonHandler(event)"/>
	</s:HGroup>
	
		
</s:SkinnableContainer>
