CREATE USER SA PASSWORD "" ADMIN
/*C1*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C2*/SET SCHEMA PUBLIC
CONNECT USER SA
create table IncidentLog (id integer generated by default as identity (start with 1), date timestamp not null, destination varchar(255), informationTypeId bigint, matcherMessage varchar(255), ruleId bigint not null, action varchar(255) not null, channel varchar(255) not null, sourceIp bigint, sourceUser varchar(255), visible bit, primary key (id))
create table IncidentLogFile (id integer generated by default as identity (start with 1), filename varchar(255) not null, content_id integer not null, incidentLog_id integer not null, primary key (id))
create table IncidentLogFileContent (id integer generated by default as identity (start with 1), localPath varchar(255), mimeType varchar(255), size bigint, primary key (id))
create table IncidentLogRequeueStatus (id integer generated by default as identity (start with 1), date timestamp, isRequeued bit not null, incidentLog_id integer, primary key (id))
create table EndpointStatus (id integer generated by default as identity (start with 1), firstAppeared timestamp not null, ipAddress varchar(255) not null, username varchar(255), isUpToDate bit, lastUpdate timestamp not null, primary key (id))
create index dateIndex on IncidentLog (date)
create index ipAddressIndex on EndpointStatus (ipAddress)
create index firstAppearedIndex on EndpointStatus (firstAppeared)
create index visibleIndex on IncidentLog (visible)
alter table IncidentLogRequeueStatus add constraint FK987DEC7E5A33480B foreign key (incidentLog_id) references IncidentLog
alter table IncidentLogFile add constraint FKDAB6258E5A33480B foreign key (incidentLog_id) references IncidentLog
alter table IncidentLogFile add constraint FKDAB6258EFE16C13B foreign key (content_id) references IncidentLogFileContent
DISCONNECT
/*C3*/SET SCHEMA PUBLIC
CONNECT USER SA
INSERT INTO INCIDENTLOG VALUES(1,'2012-08-13 12:12:12.000000007','www.mydlp.com',1,'score=5',-1,'B','W',167772191,'test@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(2,'2012-08-13 12:12:12.000000007','www.mydlp.com',2,'score=4',1,'B','W',167772191,'test@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(3,'2012-08-13 12:12:12.000000007','www.mydlp.com',3,'score=5',1,'Q','W',167772191,'test@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(4,'2012-08-13 12:12:12.000000007','www.mydlp.com',3,'score=5',-1,'L','W',167772191,'test@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(5,'2012-08-13 12:12:12.000000007','rcpt to: <test@mydlp.com>, to: <test@mydlp.com>, from: <test2@mydlp.com>',4,'score=5',1,'A','M',167772191,'test@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(6,'2012-08-13 12:12:12.000000007','rcpt to: <test@mydlp.com>, to: <test@mydlp.com>, to: <test3@mydlp.com>, from: <test2@mydlp.com>',5,'score=5',1,'B','M',167772191,'test@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(7,'2012-08-13 12:12:12.000000007','rcpt to: <test@mydlp.com>, to: <test@mydlp.com>, from: <test2@mydlp.com>, cc: <test3@mydlp.com>, cc: <test4@mydlp.com>',1,'score=5',40,'L','M',167772191,'test@mydlphq.local',FALSE)
INSERT INTO INCIDENTLOG VALUES(8,'2012-08-13 12:12:12.000000007','rcpt to: <test@mydlp.com>, to: <test@mydlp.com>, from: <test2@mydlp.com>, bcc: <test3@mydlp.com>, bcc: <test4@mydlp.com>',2,'score=4',1,'Q','M',167772191,'demo@mydlphq.local',FALSE)
INSERT INTO INCIDENTLOG VALUES(9,'2012-08-13 12:12:12.000000007','rcpt to: <test@mydlp.com>, to: <test@mydlp.com>, from: <test2@mydlp.com>, cc: <test3@mydlp.com>, cc: <test4@mydlp.com>',3,'score=5',25,'Q','M',167772191,'kerem@mydlptest.com',FALSE)
INSERT INTO INCIDENTLOG VALUES(10,'2012-08-13 12:12:12.000000007','rcpt to: <test@mydlp.com>, to: <test@mydlp.com>, from: <test2@mydlp.com>, cc: <test3@mydlp.com>, cc: <test4@mydlp.com>',3,'score=5',1,'Q','M',167772191,'demo@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(11,'2012-08-13 12:12:12.000000007','rcpt to: <test@mydlp.com>, to: <test@mydlp.com>, to: <tamtest@mydlp.com>, from: <test2@mydlp.com>, cc: <test3@mydlp.com>, cc: <test4@mydlp.com>',1,'score=5',5,'Q','M',167772191,'kerem@mydlptest.com',TRUE)
INSERT INTO INCIDENTLOG VALUES(12,'2012-08-13 12:12:12.000000007','rcpt to: <test@mydlp.com>, to: <test@mydlp.com>, from: <test2@mydlp.com>, cc: <test3@mydlp.com>, cc: <test4@mydlp.com>',2,'score=4',4,'Q','M',167772191,'demo@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(13,'2012-08-13 12:12:12.000000007','',3,'score=5',1,'Q','E',167772191,'kerem@mydlptest.com',TRUE)
INSERT INTO INCIDENTLOG VALUES(14,'2012-08-13 12:12:12.000000007','',3,'score=5',1,'L','E',167772191,'test@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(15,'2012-08-13 12:12:12.000000007','',-1,'archive_inbound',1,'A','E',167772191,'test@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(16,'2012-08-13 12:12:12.000000007','',-1,'archive_inbound',1,'A','E',167772191,'test@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(17,'2012-08-13 12:12:12.000000007','www.mydlp.com',1,'score=5',2,'B','P',167772191,'test@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(18,'2012-08-13 12:12:12.000000007','www.mydlp.com',2,'score=4',4,'B','P',167772191,'demo@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(19,'2012-08-13 12:12:12.000000007','www.mydlp.com',3,'score=5',3,'Q','P',167772191,'test@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOG VALUES(20,'2012-08-13 12:12:12.000000007','www.mydlp.com',-1,'max_size_exceeded',1,'L','P',167772191,'test@mydlphq.local',TRUE)
INSERT INTO INCIDENTLOGFILECONTENT VALUES(1,'/var/lib/mydlp/quarantine/hede.txt','text/plain',1237656757)
INSERT INTO INCIDENTLOGFILECONTENT VALUES(2,'/var/lib/mydlp/quarantine/hedo.txt','text/plain',123534)
INSERT INTO INCIDENTLOGFILECONTENT VALUES(3,'/var/lib/mydlp/quarantine/hodo.txt','text/plain',12)
INSERT INTO INCIDENTLOGFILECONTENT VALUES(4,'/var/lib/mydlp/quarantine/hodoooo.txt','text/plain',123)
INSERT INTO INCIDENTLOGFILE VALUES(1,'hede.txt',1,1)
INSERT INTO INCIDENTLOGFILE VALUES(2,'hodo.txt',2,1)
INSERT INTO INCIDENTLOGFILE VALUES(3,'dgdfg.txt',2,2)
INSERT INTO INCIDENTLOGFILE VALUES(4,'hfsdfsd.txt',3,3)
INSERT INTO INCIDENTLOGFILE VALUES(5,'test.txt',4,3)
INSERT INTO INCIDENTLOGFILE VALUES(6,'hede.txt',1,3)
INSERT INTO INCIDENTLOGFILE VALUES(7,'hodo.txt',2,4)
INSERT INTO INCIDENTLOGFILE VALUES(8,'dgdfg.txt',2,5)
INSERT INTO INCIDENTLOGFILE VALUES(9,'hfsdfsd.txt',3,6)
INSERT INTO INCIDENTLOGFILE VALUES(10,'hfsdfsd.txt',3,7)
INSERT INTO INCIDENTLOGFILE VALUES(11,'hfsdfsd.txt',3,9)
INSERT INTO INCIDENTLOGFILE VALUES(12,'hfsdfsd.txt',3,8)
INSERT INTO INCIDENTLOGFILE VALUES(13,'test2.txt',3,10)
INSERT INTO INCIDENTLOGFILE VALUES(14,'test3.txt',4,11)
INSERT INTO INCIDENTLOGFILE VALUES(15,'test5.txt',4,12)
INSERT INTO INCIDENTLOGFILE VALUES(16,'test3123.txt',1,13)
INSERT INTO INCIDENTLOGFILE VALUES(17,'testtttt3.txt',4,14)
INSERT INTO INCIDENTLOGFILE VALUES(18,'testtttt4.txt',3,15)
INSERT INTO INCIDENTLOGFILE VALUES(19,'hfsdfsd.txt',3,16)
INSERT INTO INCIDENTLOGFILE VALUES(20,'hfsdfsd.txt',3,17)
INSERT INTO INCIDENTLOGFILE VALUES(21,'hfsdfsd.txt',3,18)
INSERT INTO INCIDENTLOGFILE VALUES(22,'hfsdfsd.txt',3,19)
INSERT INTO INCIDENTLOGFILE VALUES(23,'test2.txt',3,20)
INSERT INTO INCIDENTLOGREQUEUESTATUS VALUES(4,'2012-08-13 12:12:12.000000007',TRUE, 8)
INSERT INTO INCIDENTLOGREQUEUESTATUS VALUES(5,NULL,FALSE, 9)
INSERT INTO INCIDENTLOGREQUEUESTATUS VALUES(6,'2012-08-13 12:12:12.000000007',TRUE, 10)
INSERT INTO INCIDENTLOGREQUEUESTATUS VALUES(7,'2012-08-13 12:12:12.000000007',TRUE, 11)
INSERT INTO INCIDENTLOGREQUEUESTATUS VALUES(8,'2012-08-13 12:12:12.000000007',TRUE, 12)
INSERT INTO ENDPOINTSTATUS VALUES (1, '2012-08-13 12:12:12.000000007', '10.0.0.1', NULL, FALSE, '2012-02-27 12:12:12.000000007')
INSERT INTO ENDPOINTSTATUS VALUES (2, '2012-02-20 12:12:12.000000007', '10.0.0.2', 'test@mydlp.com', TRUE, '2012-05-28 17:12:12.000000007')
INSERT INTO ENDPOINTSTATUS VALUES (3, '2012-02-20 12:12:12.000000007', '10.0.0.3', 'test2@mydlp.com', TRUE, '2012-05-28 17:19:27.000000007')
INSERT INTO ENDPOINTSTATUS VALUES (4, '2012-02-20 12:12:12.000000007', '10.0.0.4', 'test3@mydlp.com', TRUE, '2012-05-28 17:29:17.000000007')
DISCONNECT
